<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Frontend/css/ListaAnimales.css">
    <title>Animales</title>
</head>
<body>
    <header>
        <nav class="navigation-bar">
            <div class="logo">
                <a href="index.html">Fauna Colombiana</a>
            </div>
            <ul class="nav-links">
                <li><a href="#habitats">Hábitats</a></li>
                <li><a href="#sobre-nosotros">Sobre Nosotros</a></li>
                <li><a href="#animales" class="btn-animales">Animales</a></li>
            </ul>
        </nav>
    </header>
    <!-- Barra de navegación -->
    <section>
        <div class="Filtros">
            <h2>Animales</h2>
    
        <!-- Menu desplegable Tipo de Animal -->
        <form action="#">
            <label for="lang">Tipo de Animal</label>
            <select name="Tipo-animal" id="Tipo-animal">
              <option value="Mamifero">Mamifero</option>
              <option value="Aves">Aves</option>
              <option value="Reptiles">Reptiles</option>
              <option value="Peces">Peces</option>
              <option value="Ranas">Ranas</option>
            </select>
      </form>
    <!-- Menu desplegable Habitat -->
    <form action="#">
        <label for="lang">Habitat</label>
            <select name="Habitat" id="Habitat">
                <option value="Selvas-Tropicales">Selvas Tropicales</option>
                <option value="Montañas-Páramos">Montañas y Páramos</option>
                <option value="Llanuras-Sabana">Llanuras y Sabana</option>
                <option value="Ríos-Humedales">Ríos y Humedales</option>
                <option value="Costas-Playas">Costas y Playas</option>
                </select>
          </form>
          <input type="search" name="buscar" id="buscar-animal">
        </div>
    </section>
    
    <section class="animales">
        <script>
            document.addEventListener("DOMContentLoaded", async () => {
                try {
                    const cache = new Map();
                    const apiUrl = 'http://localhost:8080/api/animales';
                    
                    // Función para obtener datos (con cacheo)
                    const fetchData = async () => {
                        if (cache.has(apiUrl)) {
                            return cache.get(apiUrl); // Obtener de la caché
                        }
                        const response = await fetch(apiUrl);
                        if (!response.ok) throw new Error("Error al obtener los animales");
                        const data = await response.json();
                        cache.set(apiUrl, data); // Guardar en la caché
                        return data;
                    };

                    // Función para renderizar animales
                    const renderAnimales = (animales) => {
                        const contenedor = document.querySelector('.animales');
                        contenedor.innerHTML = ''; // Limpiar contenedor

                        const fragment = document.createDocumentFragment(); // Crear fragmento
                        animales.forEach(animal => {
                            const tarjeta = document.createElement('a');
                            tarjeta.classList.add('animal-card');
                            tarjeta.href = `/Frontend/html/animal.html?id=${animal.idAnimal}`;
                            tarjeta.innerHTML = `
                                <img class="img-animal" src="${animal.imgFondo || '/default.jpg'}" alt="${animal.nomCom}">
                                <h3>${animal.nomCom}</h3>
                                <h5>${animal.nomCie}</h5>
                                <p>${animal.regiones || 'Región no especificada'}</p>`;
                            fragment.appendChild(tarjeta); // Añadir tarjeta al fragmento
                        });
                        contenedor.appendChild(fragment); // Renderizar fragmento en el DOM
                    };

                    // Obtener y renderizar datos
                    const animales = await fetchData();
                    renderAnimales(animales);

                } catch (error) {
                    console.error("Error al cargar los animales:", error);
                }
            });

        </script>
        
    </section>
    <section class="pagination">
        <button id="prevPage" disabled>Anterior</button>
        <span id="pageInfo">Página 1</span>
        <button id="nextPage">Siguiente</button>
    </section>
    
    <footer>
        <p>© 2024 Fauna Colombiana. Todos los derechos reservados.</p>
    </footer>
</body>
</html>